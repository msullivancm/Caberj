#include "rwmake.ch"

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³CABA120 	ºAutor  ³Altamiro            º Data ³  16/05/2017      º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Tela de passagem de paramentros para o programa caba119    	   º±±
±±º          ³ controle de carencia.                                      	   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ pls                                               	   º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
User Function CABA120()


private cNomRot   := "CABA120" 
private cPerg     := "CABA120"        
private cCRLF     := CHR(13)+CHR(10)

if MSGBOX("Deseja executar esta rotina... : "+ cCRLF + cCRLF + " Confirma???","CONTROLE DE CARENCIAS","YESNO")
 
ValidPerg(cPerg)
If Pergunte(cPerg,.T.) = .F.
	Return
Endif    

Private cCodEmp      := mv_par01 
Private cContrato    := mv_par02
Private cVCont       := mv_par03 
Private cSubCon      := mv_par04
Private cVScon       := mv_par05 
Private cFamilia     := mv_par06
Private cTpReg       := mv_par07 
Private dDtInc       := dtos(mv_par08)      
Private dDtFim       := dtos(mv_par09)     
//Private nOprelac     := mv_par09 //1 - > , 2 - < , 3 - =
Private nCarencia    := mv_par10 //1 - Sem Carecia , 2 - Com Carencia , 3 - Reduzida     
Private nFazCar      := mv_par11 //1 - Sim ,2 - Não  , 3 - Ver    
                                                                                            

  If !EMPTY(cCodEmp) 

      U_CABA119(cCodEmp , cContrato , cVCont , cSubCon , cVScon , cFamilia , cTpReg ,dDtInc , dDtFim , nCarencia , nFazCar)  
   
  Else 
        
      MsgAlert("Codigo da Empresa Não Informado.", "Atenção")
  
  EndIf 
      
endif

Return Nil        

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³ValidPerg º Autor ³ Jose Carlos Noronhaº Data ³ 01/08/07    º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDescricao ³ Parametros para selecao dos titulos do PLS                 º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³                                                            º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function ValidPerg()

Local aAreaAtu := GetArea()
Local aRegs    := {}
Local i,j

DbSelectArea("SX1")
dbSetOrder(1)
cPerg := PADR(cPerg,10)



aAdd(aRegs,{cPerg,"01","Codigo da Empresa    ?","","","mv_ch1"  ,"C",04,0,0,"G","","mv_par01","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"02","Contrato             ?","","","mv_ch2"  ,"C",12,0,0,"G","","mv_par02","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"03","Versao Contrato      ?","","","mv_ch3"  ,"C",03,0,0,"G","","mv_par03","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"04","Sub Contrato         ?","","","mv_ch4"  ,"C",09,0,0,"G","","mv_par04","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"05","Versao Sub Contrato  ?","","","mv_ch5"  ,"C",03,0,0,"G","","mv_par05","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"06","Familia(matricula)   ?","","","mv_ch6"  ,"C",06,0,0,"G","","mv_par06","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"07","Tip Reg              ?","","","mv_ch7"  ,"C",02,0,0,"G","","mv_par07","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"08","Data Inclusão De     ?","","","mv_ch8"  ,"D",08,0,0,"G","","mv_par08","","","","","","","","","","","","","","","","","","","","","","","","",""    , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"09","Data Inclusão Ate    ?","","","mv_ch9"  ,"D",08,0,0,"G","","mv_par09","","","","","","","","","","","","","","","","","","","","","","","","",""    , "" , "" , "", "", "" })
//aAdd(aRegs,{cPerg,"09","Relação Data         ?","","","mv_ch9"  ,"N",01,0,0,"c","","mv_par09",">","","","","","<","","","","","=","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"10","Carencia             ?","","","mv_ch10" ,"N",01,0,0,"c","","mv_par10","Sem Carencia","","","","","Com Carencia ","","","","","Reduzida","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"11","Regerar Carencia     ?","","","mv_ch11" ,"N",01,0,0,"c","","mv_par11","Sim ","","","","","Não ","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })

/*
aAdd(aRegs,{cPerg,"09","Gera Excel           ?","","","mv_ch9" ,"N",01,0,0,"c","","mv_par09","Sim ","","","","","Não ","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"10","Procedimento         ?","","","mv_ch10" ,"C",08,0,0,"G","","mv_par10","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"11","Fase                 ?","","","mv_ch11" ,"C",01,0,0,"G","","mv_par11","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"12","Situação             ?","","","mv_ch12" ,"C",01,0,0,"G","","mv_par12","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"13","Empresa Inicial      ?","","","mv_ch13" ,"C",04,0,0,"G","","mv_par13","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"14","Empresa Final        ?","","","mv_ch14" ,"C",04,0,0,"G","","mv_par14","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })
aAdd(aRegs,{cPerg,"15","Matricula Inicial    ?","","","mv_ch15" ,"C",06,0,0,"G","","mv_par15","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"16","Matricula Final      ?","","","mv_ch16" ,"C",06,0,0,"G","","mv_par16","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"17","Plano Inicial        ?","","","mv_ch17" ,"C",04,0,0,"G","","mv_par15","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" }) 
aAdd(aRegs,{cPerg,"18","Plano Final          ?","","","mv_ch18" ,"C",04,0,0,"G","","mv_par16","","","","","","","","","","","","","","","","","","","","","","","","","" , "" , "" , "", "", "" })

//aAdd(aRegs,{cPerg,"11","Fase                 ?","","","mv_ch11" ,"N",01,0,0,"c","","mv_par11","1-Digitação ","","","","","2-Conferencia ","","","","","3-Ativa","","","","","4-Faturada","","","","","","","","","" , "" , "" , "", "", "" }) 
*/                
For i:=1 to Len(aRegs)
	If !dbSeek(cPerg+aRegs[i,2])
		RecLock("SX1",.T.)
		For j:=1 to FCount()
			If j <= Len(aRegs[i])
				FieldPut(j,aRegs[i,j])
			Endif
		Next
		MsUnlock()
	Endif
Next

RestArea( aAreaAtu )

Return(.T.)


Return()